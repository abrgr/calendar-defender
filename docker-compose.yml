version: "2"

services:
  lein:
    image: clojure:openjdk-8-lein-2.9.1-alpine
    volumes:
      - ".:/usr/src/app"
      - "./.m2:/root/.m2"
    entrypoint: ["lein"]
    working_dir: "/usr/src/app"
  proxy:
    build:
      context: .
      dockerfile: datomic-proxy.dockerfile
    command: --port 0.0.0.0:8182 calendar-defender
    ports:
      - "8182:8182"
    volumes:
      - "./.aws:/root/.aws:ro"
  aws:
    image: mesosphere/aws-cli
    volumes:
      - "./.aws:/root/.aws:ro"
